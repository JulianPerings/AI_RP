# AI RPG

A narrative-driven, AI-powered RPG where a GameMaster AI orchestrates your adventure. Interact with dynamically generated NPCs, manage inventory and relationships, and experience combat driven by a simplified d10 stat system — all wrapped in rich prose.

## Architecture

```
AI_RP/
├── app/            # Entry point, config, CLI game loop
├── agents/         # LLM-powered agents (GameMaster, NPC, Campaign Creator)
├── models/         # Pydantic data models (character, NPC, items, world state)
├── services/       # Core services (LLM, state, saves, memory, dice)
├── data/           # Campaign definitions (YAML) and save files
└── tests/          # Test suite
```

## Core Concepts

- **GameMaster Agent** — Orchestrator that receives player actions, narrates outcomes, and delegates to sub-agents.
- **NPC Agents** — Per-NPC agents with personality, memory summaries, and relationship tracking.
- **Campaign Creator Agent** — Generates campaign YAML files from high-level prompts.
- **Hybrid Combat** — d10 + stat modifier rolls resolved mechanically, then narrated by the GM.
- **Persistent NPC Memory** — Recent interactions stored verbatim; older ones summarized to keep context windows small.

## Stat System

Four core stats, d10-based checks:

| Stat       | Governs                                      |
|------------|----------------------------------------------|
| Strength   | Melee damage, physical feats, carrying        |
| Agility    | Dodge, ranged attacks, stealth, initiative     |
| Mind       | Magic, lore, perception, puzzles               |
| Charisma   | Persuasion, intimidation, NPC disposition      |

**Checks**: `d10 + stat_modifier + skill_bonus` vs. difficulty threshold.

## Setup

```bash
# 1. Create and activate a virtual environment
python -m venv venv
source venv/bin/activate

# 2. Install dependencies
pip install -r requirements.txt

# 3. Copy and fill in your API keys
cp .env.example .env
# Edit .env with your keys

# 4. Run the game
python -m app.main
```

## Configuration

Copy `.env.example` to `.env` and set your API keys. Supported LLM providers:

- **OpenAI** (default)
- **xAI** (Grok)
- **Gemini**

Set `DEFAULT_LLM_PROVIDER` in `.env` to choose the default provider. You can also:

- **Pick at startup**: the game shows all providers with their model and key status
- **CLI flag**: `python -m app.main --provider xai` to skip the prompt

## Debug Mode

See exactly what the agents are thinking — every LLM request and response is logged.

```bash
# Start in debug mode
python -m app.main --debug

# Or set the env var
AI_RPG_DEBUG=1 python -m app.main
```

You can also toggle debug mode **during gameplay** by typing `debug`.

Logs go to both the console (stderr) and timestamped files in `logs/`. This lets you inspect:
- Full system prompts sent to each agent
- World context injected per turn
- Raw LLM responses (including structured JSON actions)
- NPC agent delegation and memory updates

## Campaign Format

Campaigns are defined as YAML files in `data/campaigns/`. See `data/campaigns/example_campaign.yaml` for the schema. Campaigns can be hand-written or generated by the Campaign Creator agent.

## License

MIT
